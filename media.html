<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DevCommandHub Chat</title>
  <style>
    :root {
      --vscode-font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --vscode-font-size: 13px;
      --vscode-sideBar-background: #252526;
      --vscode-sideBar-foreground: #cccccc;
      --vscode-sideBar-border: #2d2d30;
      --vscode-sideBarTitle-foreground: #cccccc;
      --vscode-icon-foreground: #c5c5c5;
      --vscode-toolbar-hoverBackground: #2a2d2e;
      --vscode-list-hoverBackground: #2a2d2e;
      --vscode-charts-blue: #007acc;
      --vscode-foreground: #cccccc;
      --vscode-symbolIcon-functionForeground: #dcdcaa;
      --vscode-descriptionForeground: #9d9d9d;
      --vscode-textCodeBlock-background: #1e1e1e;
      --vscode-textPreformat-foreground: #d4d4d4;
      --vscode-textBlockQuote-border: #404040;
      --vscode-editor-font-family: 'Consolas', 'Courier New', monospace;
      --vscode-panel-border: #2d2d30;
      --vscode-button-background: #0e639c;
      --vscode-button-foreground: #ffffff;
      --vscode-button-border: #464647;
      --vscode-button-hoverBackground: #464647;
      --vscode-input-background: #3c3c3c;
      --vscode-input-border: #464647;
      --vscode-focusBorder: #007fd4;
      --vscode-input-foreground: #cccccc;
      --vscode-input-placeholderForeground: #9d9d9d;
      --vscode-scrollbarSlider-background: #79797966;
      --vscode-scrollbarSlider-hoverBackground: #646464b3;
    }
    body {
      font-family: var(--vscode-font-family);
      font-size: var(--vscode-font-size);
      background: var(--vscode-sideBar-background);
      color: var(--vscode-sideBar-foreground);
      margin:0;
      padding:0;
      height:100vh;
      display:flex;
      flex-direction:column;
    }

    .chat-header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:8px 16px;
      background:var(--vscode-sideBar-background);
      border-bottom:1px solid var(--vscode-sideBar-border);
      min-height:35px;
    }

    .chat-title {
      font-size:11px;
      font-weight:600;
      color:var(--vscode-sideBarTitle-foreground);
      text-transform:uppercase;
      letter-spacing:.5px;
    }

    .chat-actions {
      display:flex;
      gap:4px;
    }

    .action-button {
      width:22px;
      height:22px;
      background:transparent;
      border:none;
      border-radius:3px;
      color:var(--vscode-icon-foreground);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:12px;
    }
    .action-button:hover { background:var(--vscode-toolbar-hoverBackground); }

    .chat-container { flex:1; overflow-y:auto; display:flex; flex-direction:column; }

    .conversation-item { padding:12px 16px; border-bottom:1px solid var(--vscode-sideBar-border); display:flex; flex-direction:column; gap:8px; }
    .conversation-item:hover { background:var(--vscode-list-hoverBackground); }

    .user-message { display:flex; align-items:flex-start; gap:8px; }
    .user-avatar { width:20px; height:20px; border-radius:50%; background:var(--vscode-charts-blue); color:#fff; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:bold; flex-shrink:0; }
    .user-name { font-size:12px; font-weight:600; color:var(--vscode-foreground); margin-bottom:4px; }
    .user-message-content { font-size:13px; color:var(--vscode-foreground); line-height:1.4; }

    .bot-response { margin-left:0; padding-left:0; }
    .copilot-header { display:flex; align-items:center; gap:8px; margin-bottom:8px; }
    .copilot-icon { width:16px; height:16px; background:var(--vscode-symbolIcon-functionForeground); border-radius:3px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:10px; font-weight:bold; }
    .copilot-label { font-size:12px; font-weight:600; color:var(--vscode-foreground); }
    .copilot-meta { font-size:11px; color:var(--vscode-descriptionForeground); margin-left:auto; }

    .bot-message-content { font-size:13px; line-height:1.5; color:var(--vscode-foreground); }
    .bot-message-content code { background:var(--vscode-textCodeBlock-background); color:var(--vscode-textPreformat-foreground); padding:1px 4px; border-radius:3px; font-family:var(--vscode-editor-font-family); font-size:12px; }

    .code-block {
      background:var(--vscode-textCodeBlock-background);
      border:1px solid var(--vscode-textBlockQuote-border);
      border-radius:4px;
      padding:12px;
      margin:8px 0;
      font-family:var(--vscode-editor-font-family);
      font-size:12px;
      color:var(--vscode-textPreformat-foreground);
      overflow-x:auto;
      white-space:pre-wrap;
      position:relative;
    }
    .code-block.output-content { border-left: 3px solid var(--vscode-charts-blue); }
    .code-block.error-content { border-left: 3px solid #dc3545; background: rgba(220,53,69,0.05); }

    .collapsible-output { margin: 8px 0; }
    .output-preview-fade { position:absolute; bottom:0; left:0; right:0; height:20px; background:linear-gradient(transparent, var(--vscode-textCodeBlock-background)); pointer-events:none; }
    .expand-btn,.collapse-btn{
      background:var(--vscode-button-background); color:var(--vscode-button-foreground);
      border:1px solid var(--vscode-button-border); border-radius:4px; padding:6px 12px; font-size:11px; cursor:pointer; margin:4px 0; display:flex; align-items:center; gap:4px; transition:background-color .2s ease;
    }
    .expand-btn:hover,.collapse-btn:hover{ background:var(--vscode-button-hoverBackground); }
    .collapsed-content{ animation:expandOut .3s ease-out; }
    @keyframes expandOut{ from{opacity:0;max-height:0;} to{opacity:1;max-height:500px;} }

    .syntax-error{color:#f48771;font-weight:bold;}
    .syntax-warning{color:#ffcc02;font-weight:bold;}
    .syntax-success{color:#73c991;font-weight:bold;}
    .syntax-info{color:#75beff;}
    .syntax-json{color:#ce9178;}
    .syntax-url{color:#3794ff;text-decoration:underline;}
    .syntax-k8s{color:#4ec9b0;font-weight:bold;}
    .syntax-path{color:#d7ba7d;}
    .syntax-number{color:#b5cea8;}

    .status-badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:11px;font-weight:bold;text-transform:uppercase;letter-spacing:.5px;}
    .status-badge.queued{background:rgba(255,193,7,.2);color:#ffc107;border:1px solid #ffc107;}
    .status-badge.running{background:rgba(0,123,255,.2);color:#007bff;border:1px solid #007bff;animation:pulse 2s infinite;}
    .status-badge.completed{background:rgba(40,167,69,.2);color:#28a745;border:1px solid #28a745;}
    .status-badge.failed{background:rgba(220,53,69,.2);color:#dc3545;border:1px solid #dc3545;}
    .status-badge.cancelled{background:rgba(108,117,125,.2);color:#6c757d;border:1px solid #6c757d;}

    .action-btn{
      background:var(--vscode-button-background); color:var(--vscode-button-foreground);
      border:1px solid var(--vscode-button-border); border-radius:4px; padding:6px 12px; font-size:11px; cursor:pointer; display:inline-flex; align-items:center; gap:4px; margin:4px 8px 4px 0; transition:all .2s ease;
    }
    .action-btn:hover:not(:disabled){ background:var(--vscode-button-hoverBackground); transform:translateY(-1px); }
    .action-btn:disabled{opacity:.5;cursor:not-allowed;}
    .action-btn.refresh-btn{background:transparent;border-color:var(--vscode-charts-blue);color:var(--vscode-charts-blue);}
    .action-btn.refresh-btn:hover:not(:disabled){background:rgba(0,122,204,.1);}
    .action-btn.retry-btn{background:transparent;border-color:#ffc107;color:#ffc107;}
    .action-btn.retry-btn:hover:not(:disabled){background:rgba(255,193,7,.1);}

    .input-section{ border-top:1px solid var(--vscode-panel-border); background:var(--vscode-sideBar-background); padding:12px 16px; }

    .add-context-row{ display:flex; align-items:center; gap:8px; margin-bottom:8px; font-size:11px; color:var(--vscode-descriptionForeground); }
    .add-context-button{ background:transparent; border:1px solid var(--vscode-button-border); border-radius:4px; padding:4px 8px; font-size:11px; color:var(--vscode-foreground); cursor:pointer; display:flex; align-items:center; gap:4px; }
    .add-context-button:hover{ background:var(--vscode-button-hoverBackground); }
    .current-file{ display:flex; align-items:center; gap:4px; font-size:11px; color:var(--vscode-descriptionForeground); margin-left:auto; }

    .input-container{ display:flex; align-items:flex-end; gap:8px; background:var(--vscode-input-background); border:1px solid var(--vscode-input-border); border-radius:6px; padding:8px 12px; min-height:18px; }
    .input-container:focus-within{ border-color:var(--vscode-focusBorder); outline:none; }

    .input-field{ flex:1; background:transparent; border:none; outline:none; color:var(--vscode-input-foreground); font-family:var(--vscode-font-family); font-size:13px; resize:none; min-height:18px; max-height:120px; overflow-y:auto; }
    .input-field::placeholder{ color:var(--vscode-input-placeholderForeground); }

    .input-actions{ display:flex; gap:4px; align-items:center; }

    .input-action{ width:20px; height:20px; background:transparent; border:none; color:var(--vscode-icon-foreground); cursor:pointer; border-radius:3px; display:flex; align-items:center; justify-content:center; font-size:12px; transition:all .2s ease; }
    .input-action:hover:not(:disabled){ background:var(--vscode-toolbar-hoverBackground); }
    .input-action:disabled{ opacity:.5; cursor:not-allowed; }
    .input-action.loading{ animation:pulse 1.5s ease-in-out infinite; }

    @keyframes pulse { 0%{opacity:1;} 50%{opacity:.5;} 100%{opacity:1;} }

    .input-action#askBtn:not(:disabled),
    .input-action#submitBtn:not(:disabled){
      background:var(--vscode-button-background);
      color:var(--vscode-button-foreground);
      border:1px solid var(--vscode-button-border);
      border-radius:4px;
    }
    .input-action#askBtn:not(:disabled){ padding:2px 6px; font-weight:500; min-width:28px; }
    .input-action#askBtn:hover:not(:disabled),
    .input-action#submitBtn:hover:not(:disabled){ background:var(--vscode-button-hoverBackground); }

    .chat-container::-webkit-scrollbar{ width:8px; }
    .chat-container::-webkit-scrollbar-thumb{ background:var(--vscode-scrollbarSlider-background); border-radius:4px; }
    .chat-container::-webkit-scrollbar-thumb:hover{ background:var(--vscode-scrollbarSlider-hoverBackground); }

    .error-message{ background:rgba(220,53,69,.15); border:1px solid #dc3545; padding:8px 12px; border-radius:4px; margin:8px 0; font-size:12px; }
    .error-banner{ background:rgba(220,53,69,.15); border:1px solid #dc3545; padding:8px 12px; border-radius:4px; margin:8px 0; display:flex; align-items:center; justify-content:space-between; font-size:12px; }

    .toast{
      position:fixed; top:20px; right:20px; background:var(--vscode-sideBar-background);
      border:1px solid var(--vscode-sideBar-border); border-radius:6px; padding:12px 16px;
      box-shadow:0 4px 12px rgba(0,0,0,.3); z-index:1000; max-width:300px; animation:slideIn .3s ease-out;
    }
    @keyframes slideIn{ from{ transform:translateX(100%); opacity:0; } to{ transform:translateX(0); opacity:1; } }
    .toast.error{ border-color:#dc3545; background:rgba(220,53,69,.1); }
    .toast.success{ border-color:#28a745; background:rgba(40,167,69,.1); }
    .toast.warning{ border-color:#ffc107; background:rgba(255,193,7,.1); }
    @keyframes slideOut{ from{ transform:translateX(0); opacity:1; } to{ transform:translateX(100%); opacity:0; } }
  </style>
</head>
<body>
  <div class="chat-header">
    <div class="chat-title">Chat</div>
    <div class="chat-actions">
      <button class="action-button" title="New Chat" type="button" aria-label="New Chat">↻</button>
      <button class="action-button" title="Clear Chat" type="button" aria-label="Clear Chat">🗑</button>
      <button class="action-button" title="More" type="button" aria-label="More">⋯</button>
    </div>
  </div>

  <div class="chat-container" id="chatContainer"></div>

  <div class="input-section">
    <div class="add-context-row">
      <button class="add-context-button" id="addContextBtn" type="button">📎 Add Context...</button>
      <div class="current-file">📄 extension.ts Current file</div>
    </div>

    <div class="input-container">
      <textarea class="input-field" id="inputField" placeholder="Ask a Question" rows="1"></textarea>
      <div class="input-actions">
        <button class="input-action" id="attachBtn" title="Attach" type="button" aria-label="Attach">📎</button>
        <button class="input-action" id="mentionBtn" title="Mention" type="button" aria-label="Mention">@</button>
        <button class="input-action" id="askBtn" title="Ask" type="button" aria-label="Ask">Ask</button>
        <button class="input-action" id="submitBtn" title="Submit" type="button" aria-label="Submit">▶</button>
      </div>
    </div>
  </div>
</body>
</html>
